This is a significantly reduced version to fit within the response limits. Remember to add more comprehensive test cases, error handling, and potentially more advanced problem solutions (e.g., brute force vs. optimized, memory-efficient versions) to make this a truly substantial project.  You can expand this foundation to reach the 1000+ lines of code goal. Remember to handle memory management carefully to prevent leaks (as shown in the destructor).  Consider adding a Makefile for easier compilation.